<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Police Precinct: Dispatcher</title>

  <!-- PWA -->
  <meta name="theme-color" content="#0b1320" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png" />

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">

<!-- UPDATE BANNER -->
<div id="updateBanner" class="update-banner hidden">
  <div class="update-text">
    Update available
    <span class="muted">‚Äî refresh to load the latest version.</span>
  </div>
  <div class="update-actions">
    <button class="btn small" id="btnUpdateLater">Later</button>
    <button class="btn small primary" id="btnUpdateNow">Refresh</button>
  </div>
</div>

    <div class="brand">
<button id="homeBadgeBtn" type="button" class="brand-home" aria-label="Go to Home">
  <img src="badge.png" width="40" alt="Police Precinct Home" />
</button>


      <div class="brand-title"><!--Police Precinct: Dispatcher--></div>
      <div class="brand-subtitle"><!--Companion App--></div>
    </div>

    <div class="header-actions">
      <button class="icon-btn hidden" id="btnInstallApp" title="Install App">‚¨áÔ∏è</button>
      <button class="icon-btn" id="btnStartPlayer" title="Starting Player Selector">üõ°Ô∏è</button>
      <button class="icon-btn" id="btnDice" title="Dice Roller">üé≤</button>
      <button class="icon-btn" id="btnQuickAudio" title="Audio">üîä</button>
      <button class="icon-btn" id="btnOpenSettings" title="Settings">‚öôÔ∏è</button>
    </div>
  </header>

  <main class="app-main">
    <!-- HOME VIEW -->
    <section id="viewHome" class="view" style="height:unset">
      <div class="panel">
        <div class="panel-body" style="background:unset;border:unset;box-shadow:unset">

<div style="display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 50px">
<div style="flex-shrink: 0; width:60px">
  <img src="badge.png" style="width: 60px;">
</div>

<div class="hero" style="flex-grow: 1;text-align:center">
            <div class="hero-title" style="text-align: center;">POLICE PRECINCT</div>
            <div class="hero-text" style="text-align: center;font-weight: bold;">DISPATCHER</div>
</div>
<!--
          <div class="hero">
            <div class="hero-title">Dispatcher Console</div>
            <div class="hero-text">
              Track team actions, radio dispatches, commendations, and timed crises.
            </div>
          </div>
-->

<div style="flex-shrink: 0; width:60px">
  <img src="badge.png" style="width: 60px;">
</div>
</div>

          <div class="home-buttons">

<button id="btnBeginShift" class="pp-begin-btn" type="button" style="width:300px; height: 80px">
  <span class="pp-begin-text">BEGIN SHIFT</span>
</button>

<!--
<button class="pp-begin-btn continue-shift" type="button" style="width:300px; height: 80px">
  <span class="pp-begin-text">CONTINUE SHIFT</span>
</button>

<button class="pp-begin-btn continue-shift" type="button" style="width:300px; height: 80px">
  <span class="pp-begin-text continue-shift">SETTINGS</span>
</button>
-->

            <!-- <button class="btn primary" id="btnBeginShift">Begin Shift</button> -->
            <button class="btn" id="btnSetup">Setup</button>
            <button class="btn" id="btnSettings">Settings</button>
          </div>

          <div class="home-secondary">
            <button class="btn subtle" id="btnHowTo">How to Use</button>
            <button class="btn subtle" id="btnClearData">Reset App Data</button>
          </div>
<!--
          <div class="hint">
            Tip: The main game screen is designed to fit without scrolling on mobile.
          </div>
-->
        </div>
      </div>
    </section>

    <!-- GAME VIEW -->
    <section id="viewGame" class="view">
      <div class="game-topbar">
        <div class="topbar-left">
          <div class="stat-pill" id="pillOverall">
            Overall: <span class="mono" id="overallPct">0%</span>
          </div>
          <div class="stat-pill">
            Actions: <span class="mono" id="overallActions">0</span>
          </div>
        </div>

        <div class="topbar-right">
          <button class="btn small" id="btnActivityLog">Case Log</button>
          <button class="btn small warn" id="btnEndShift">End Shift</button>
        </div>
      </div>

      <!-- Active Dispatches strip -->
      <div id="activeDispatchStrip" class="dispatch-strip hidden">
        <div class="dispatch-title"><!-- Active Dispatches --></div>

        <div class="dispatch-scroll-wrap">
          <div class="dispatch-fade left" id="dispatchFadeLeft"></div>
          <div class="dispatch-fade right" id="dispatchFadeRight"></div>

          <div id="activeDispatchList" class="dispatch-scroll"></div>
        </div>
      </div>


      <div class="grid-3">
        <!-- Investigation -->
        <div class="card card-investigation" data-cat="investigation">
          <div class="card-header">
            <div class="card-title">



<div class="secLeft">
                <div class="secIcon" aria-hidden="true">
<svg style="margin: 4px 0 0 5px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search w-6 h-6 text-investigation"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></div>
                <div class="mono" style="min-width:0;">
                  <div class="secTitle">INVESTIGATION</div>
                </div>
              </div>



<!--
<div class="secIcon" aria-hidden="true">
<svg style="margin: 4px 0 0 5px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search w-6 h-6 text-investigation"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></div>
Investigation

--></div>

            <button class="card-instructions" type="button" data-open="actionHelp" data-cat="investigation" aria-label="Investigation help">
              Draw Cards to find clues
            </button>
            <div class="card-meta">
              <span class="mono pct-debug" id="investigationPct">0%</span>
              <span class="led" id="investigationLed" title="Investigation success rate"></span>
            </div>
          </div>

          <div class="card-body">
            <div class="btn-row">
              <button class="btn success segmented" data-action="success" data-cat="investigation" aria-label="Investigation success (clues found)">
                <span class="seg" data-amount="1">1</span>
                <span class="seg" data-amount="2">2+</span>
              </button>
              <button class="btn danger" data-action="fail" data-cat="investigation">FAIL</button>
            </div>

            <div class="counts counts-hidden">
              <div>‚úÖ <span class="mono" id="investigationSuccess">0</span></div>
              <div>‚ùå <span class="mono" id="investigationFail">0</span></div>
              <div>üîé <span class="mono" id="investigationPoints">0</span></div>
            </div>

            <div class="progress-wrap" id="investigationCommWrap">
              <div class="progress-label">
                Commendation: <span class="mono" id="investigationCommText">0/3</span>
              </div>

<div class="container">
  <div class="expanding">
    <div class="progress">
      <div class="bar" id="investigationCommBar" style="width:0%"></div>
    </div>
  </div>
  <div class="fixed-width">üèÖ</div>
</div>

            </div>
          </div>
        </div>

        <!-- Arrest -->
        <div class="card card-arrest" data-cat="arrest">
          <div class="card-header">


<div class="secLeft">
                <div class="secIcon" aria-hidden="true">
<svg style="margin: 5px 0 0 5px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-link w-6 h-6 text-arrest"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div>
                <div class="mono" style="min-width:0;">
                  <div class="secTitle">ARREST</div>
                </div>
              </div>



<!--
            <div class="card-title">üîó Arrest</div>
-->

            <button class="card-instructions" type="button" data-open="actionHelp" data-cat="arrest" aria-label="Arrest help">
              Roll Dice to remove punks
            </button>
            <div class="card-meta">
              <span class="mono pct-debug" id="arrestPct">0%</span>
              <span class="led" id="arrestLed" title="Arrest success rate"></span>
            </div>
          </div>

          <div class="card-body">
            <div class="btn-row">
              <button class="btn success segmented" data-action="success" data-cat="arrest" aria-label="Arrest success (thugs removed)">
                <span class="seg" data-amount="1">1</span>
                <span class="seg" data-amount="2">2</span>
                <span class="seg" data-amount="3">3+</span>
              </button>
              <button class="btn danger" data-action="fail" data-cat="arrest">FAIL</button>
            </div>

            <div class="counts counts-hidden">
              <div>‚úÖ <span class="mono" id="arrestSuccess">0</span></div>
              <div>‚ùå <span class="mono" id="arrestFail">0</span></div>
              <div>üëÆ <span class="mono" id="arrestPoints">0</span></div>
            </div>

            <div class="progress-wrap" id="arrestCommWrap">
              <div class="progress-label">
                Commendation: <span class="mono" id="arrestCommText">0/4</span>
              </div>

<div class="container">
  <div class="expanding">
    <div class="progress">
      <div class="bar" id="arrestCommBar" style="width:0%"></div>
    </div>
  </div>
  <div class="fixed-width">üèÖ</div>
</div>

            </div>
          </div>
        </div>

        <!-- Emergency -->
        <div class="card card-emergency" data-cat="emergency">
          <div class="card-header">

<div class="secLeft">
                <div class="secIcon" aria-hidden="true">
<svg style="margin: 2px 0 0 5px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-siren w-6 h-6 text-emergency"><path d="M7 18v-6a5 5 0 1 1 10 0v6"></path><path d="M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z"></path></svg></div>
                <div class="mono" style="min-width:0;">
                  <div class="secTitle">EMERGENCY</div>
                </div>
              </div>

<!--
            <div class="card-title">üö® Emergency</div>
-->
            <button class="card-instructions" type="button" data-open="actionHelp" data-cat="emergency" aria-label="Emergency help">
              Roll Dice to handle emergency
            </button>
            <div class="card-meta">
              <span class="mono pct-debug" id="emergencyPct">0%</span>
              <span class="led" id="emergencyLed" title="Emergency success rate"></span>
            </div>
          </div>

          <div class="card-body">
            <div class="btn-row">
              <button class="btn success" data-action="success" data-cat="emergency">SUCCESS</button>
              <button class="btn danger" data-action="fail" data-cat="emergency">FAIL</button>
            </div>

            <div class="counts counts-hidden">
              <div>‚úÖ <span class="mono" id="emergencySuccess">0</span></div>
              <div>‚ùå <span class="mono" id="emergencyFail">0</span></div>
            </div>

            <div class="progress-wrap" id="emergencyCommWrap">
              <div class="progress-label">
                Commendation: <span class="mono" id="emergencyCommText">0/5</span>
              </div>

<div class="container">
  <div class="expanding">
    <div class="progress">
      <div class="bar" id="emergencyCommBar" style="width:0%"></div>
    </div>
  </div>
<div class="fixed-width">üèÖ</div>
</div>

            
          </div>
        </div>
      </div>

      <footer class="game-footer">
        <div class="footer-left">
          <button class="btn small" id="btnOpenSettings2">Settings</button>
        </div>
        <div class="footer-right">
          <div class="tiny muted">v0.2 PWA bones build</div>
        </div>
      </footer>
    </section>
  </main>

  <!-- MODAL OVERLAY -->
  <div id="modalOverlay" class="overlay hidden" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle">Modal</div>
        <div class="modal-header-center" id="modalHeaderCenter"></div>
        <button class="icon-btn" id="btnCloseModal" title="Close">‚úñ</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
      <div class="modal-footer" id="modalFooter"></div>
    </div>
  </div>

  <!-- STARTING PLAYER SELECTOR (FULLSCREEN) -->
  <div id="startPlayerOverlay" class="overlay hidden startplayer-overlay" aria-hidden="true">
    <div class="startplayer-shell" role="dialog" aria-modal="true" aria-labelledby="startPlayerTitle">
      <div class="startplayer-header">
        <div class="startplayer-title" id="startPlayerTitle">Starting Player Selector</div>
        <button class="icon-btn" id="btnCloseStartPlayer" title="Close">‚úñ</button>
      </div>

      <div class="startplayer-stage" id="startPlayerStage">
        <canvas id="startPlayerCanvas"></canvas>

        <div class="startplayer-hud">
          <div class="startplayer-hint" id="startPlayerHint">
            Place a finger on the screen. When everyone is ready, hold steady to randomly choose.
          </div>

          <div class="startplayer-countdown hidden" id="startPlayerCountdown">
            Choosing in <span class="mono" id="startPlayerCountdownNum">3</span>‚Ä¶
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
